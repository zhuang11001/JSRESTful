<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>瑞证通--手机云证办理</title>
		<link rel="stylesheet" href="css/font-awesome.css">
		<link rel="stylesheet" href="css/bootstrap.css">
		<link rel="stylesheet" href="css/realNameExt.css">
		<style>
			body{
				background: #fff;
			}
			form p{
				font-weight: bold;
				color:rgba(25,26,27,1);
			}
			.realName-Center{
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				-webkit-transform: translate(-50%, -50%);
			}
			.uploadImg{
				padding-left: 20px;
			}
			.uploadImg p{
				color:#999999;
				margin-left: 25px;
			}
			.uploadImg p:first-child{
				color:#999999;
			}
			.uploadImgBox{
				width: 200px;
				height: 200px;
				border: 2px solid #DBDBDB;
				position: relative;
				float:left;
				cursor:pointer;
			}
			.uploadImgBox img{
				position: absolute;
				width: 199px;
				height: 199px;
				top: 0;
				left: 0;
			}
			.modal-body span{
				font-weight: bold;
				color: #191A1B;
				font-size: 17px;
				margin: 10px 0;
				display: inline-block;
			}
			.modal-body p{
				color: #4F5051;
			}
			.btn-default{
				background:#67A2EB;
				color: #fff;
			}
			
			@media (min-width: 768px) {
			
				.modal-dialog {
					width: 60% !important;
					margin: 30px auto;
				}
			}
			</style>
	</head>
	<body>
		<nav class="navbar scrollspy navbar-fixed-top  navbar-default">
			<div class="container">
				<div class="navbar-header ">
					<span><img src="images/logo.png" height="62px" alt="Logo" class="logoImg"></span>
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse"
					 aria-expanded="false">
						<span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
				</div>
				<div class="collapse navbar-collapse" id="navbar-collapse">
					<ul class="nav navbar-nav navbar-right">
						<li><a data-track="" data-track-location="header" href="javascript:void(0);" style=""><img src="images/customerService.png"
								 alt="" class="customerServiceImg">客服热线：0591968975</a></li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown">
								<img src="./images/userLogo-small.png" alt="" style="width: 25px;">
								<b class="caret"></b>
							</a>
							<ul class="dropdown-menu">
								<li><a href="openPage?url=commons/change-password">修改密码</a></li>
								<li><a href="loginOut">安全退出</a></li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</nav>
		<div class="row" style="margin-top:56px;background: #fff;">
			<div class="col-md-6" style="padding:2% 2% 2% 6%;">
				<form action="" method="">
					<p>
						营业执照统一社会信用代码
					</p>
					<div class="uploadImg">
						<div class="uploadImgBox phoneBox" type="orgCertificateBase64" id="orgCertificateBase64">
							<img src="" alt="">
							<input type="" name="" id="" value="orgCertificateBase64"  style="display: none;"/>
							<div style="height: 100px;width:3px;background:#DBDBDB" class="realName-Center"></div>
							<div style="width: 100px;height:3px;background:#DBDBDB" class="realName-Center"></div>
						</div>
						<div style="float: left;">
							<p>营业执照/统一社会信用代码</p>
							<p>请上传登记执照支持.jpg.jpge.png</p>
						</div>
						<div style="clear: both;"></div>
					</div>
					<p>
						企业印模上传
					</p>
					<div class="uploadImg">
						<div class="uploadImgBox phoneBox" type="officialSealBase64">
							<img src="" alt="">
							<div style="height: 100px;width:3px;background:#DBDBDB" class="realName-Center"></div>
							<div style="width: 100px;height:3px;background:#DBDBDB" class="realName-Center"></div>
						</div>
						<div style="float: left;">
							<p>企业印模</p>
							<p>请上传企业印模照，支持.jpg.jpge.png</p>
							<img src="./images/117D29EA-85FC-4018-83FD-0A6C15DFA4CA.png" alt="" style="width: 340px;">
						</div>
						<div style="clear: both;"></div>
					</div>
					<div class="form-group">
						<label for="name">企业名称</label>
						<input type="text" class="form-control" name="enterpriseName" placeholder="填写企业名称">
					</div>
					<input type="file" accept="image/gif, image/jpeg, image/jpg, image/png" id="uploadImg" value="+" style="display: none;position:absolute;width:100%; height: 100%;border:none">
					<div style="display: none;">
						<input type="" name="address" id="" value="" />
						<input type="" name="business" id="" value="" />
						<input type="" name="capital" id="" value="" />
						<input type="" name="establishDate" id="" value="" />
					</div>
				</form>
			</div>
			<div class="col-md-6" style="padding:2% 6% 2% 2%">
				<form role="form">
					<div class="form-group">
						<label for="name">营业执照注册号/统一社会信用代码 </label>
						<input type="text" class="form-control" name="regNum" placeholder="填写15位营业执照注册号或是18位统一社会信用代码">
					</div>
					<div class="form-group">
						<label for="name">法定代表人姓名</label>
						<input type="text" class="form-control" name="legalName" placeholder="填写与执照上一致的法定代表人签名">
					</div>
					<div class="form-group">
						<label for="name">法定代表人身份证号</label>
						<input type="text" class="form-control" name="legalCard" placeholder="填写与执照上一致的法定代表人身份证号" readonly="">
					</div>
					<div class="form-group">
						<label for="name">法定代表人手机号</label>
						<input type="text" class="form-control" name="mobilePhone" placeholder="填写法定代表人手机号" readonly="">
					</div>
					<div class="form-group sendSmsCode" style="position: relative;">
						<label for="name">短信验证码</label>
						<input type="text" class="form-control" name="smsCode" placeholder="填写短信验证码">
						<button type="button" class="btn btn-primary" id="getsmsCode" onclick="getSmsCode()">获取验证码</button>
					</div>
				</form>
				<p style="line-height: 16px;color: #222222;">
					<input type="checkbox" name="" id="checkBox" value="" style="height: 16px;vertical-align: middle;height: 47px;" />
					<span>我已阅读并同意</span>
					<a href="javascript:void(0);" style="margin-left: 10px;" data-toggle="modal" data-target="#myModal">
						<数字证书（云证）办理申请协议>
					</a>
				</p>
				<button type="button" class="btn btn-primary" style="float: right;height: 47px;" disabled="" id="submit">&nbsp;&nbsp;&nbsp;提交&nbsp;&nbsp;</button>
			</div>
		</div>
		<!-- 系统主页${processStatus};${userId};${user};${personalAuthUrl}; -->
		<!-- 模态框（Modal） -->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		    <div class="modal-dialog">
		        <div class="modal-content">
		            <div class="modal-header">
		                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		                <h4 class="modal-title" id="myModalLabel" style="text-align: center;">数字证书（云证）办理申请协议</h4>
		            </div>
		            <div class="modal-body">
						<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本协议由福建瑞术信息科技有限公司（下称“瑞术科技”）旗下瑞签云平台与数字证书用户（下称“用户”或“您”）之间签署，本协议具有合同效力。瑞术科技作为合作CA机构的授权审核机构，有权与用户签署本协议。CA机构作为权威、可信、公正的第三方电子认证服务机构，根据国家相关法律、法规，为用户提供合法的数字证书申请、审核、签发和管理等电子认证服务。为明确各方权利和义务，瑞术科技和用户就数字证书的申请和使用等事宜达成以下协议，共同遵守执行。</p>
						<span>第一条 定义</span>
						<p>1.数字证书：电子认证服务机构签发的包含数字证书使用者身份信息和公开密钥的电子文件。</p>
						<p>2.CA机构：工业和信息化部批准的电子认证服务机构和国家密码管理局批准的电子政务电子认证服务机构，遵照《中华人民共和国电子签名法》为用户提供数字证书相关的电子认证服务。</p>
						<p>3.瑞术科技：福建瑞术信息科技有限公司，相关CA机构的授权审核机构，为用户提供数字证书颁发的申请、审核等服务。</p>
						<p>4.瑞签云平台：福建瑞术信息科技有限公司旗下为企业、个人用户，提供手机云证、云章的电子认证服务平台。</p>
						<p>5.用户：数字证书持有人以及申请使用数字证书的主体。</p>
						<span>第二条 声明</span>
						<p>1.您应在申请数字证书以前务必仔细阅读本协议，若您不同意本协议的任意内容，或者无法准确理解瑞术科技对条款的解释，请不要点击同意并进行后续操作； 若您点击同意，则表示您对本协议的全部内容已充分阅读并认可和同意遵守，同时，承诺遵守中国法律、法规、规章及其他政府规范性文件的规定， 如有违反而造成任何法律后果，您将以本人名义独立承担所有相应的法律责任。</p>
						<p>2.您点击同意即表示您同意瑞签云平台将您的个人身份信息或单位信息传输至瑞术科技与CA机构用于申请数字证书。</p>
						<span>第三条 申请</span>
						<p>1.用户同意通过瑞签云平台向瑞术科技合作的CA机构申请并使用该机构颁发给用户的数字证书，承诺在申请证书时提供真实、完整和准确的信息及证明材料。如因故意或过失未提供真实、完整和准确的信息，导致CA机构签发证书错误，造成相关各方损失的，由用户承担相关责任。</p>
						<p>2.瑞术科技作为CA机构的授权审核机构，负责用户的信息核实、身份认证等工作。用户在申请数字证书时应遵照CA机构的规程办理手续。</p>
						<p>3.瑞术科技应积极响应用户发出的证书申请请求，及时通过CA机构为用户签发证书。如果由于设备或网络故障而导致签发数字证书错误、延迟、中断或者无法签发，瑞术科技和CA机构不承担任何赔偿责任。</p>
						<p>4.用户在获得数字证书时应及时验证此证书所匹配的用户信息，如无异议则视为接受证书并承担该证书使用的责任和后果。</p>
						<span>第四条 使用</span>
						<p>1.数字证书用于网络上的用户身份标识、数字签名验证及密钥分配，各应用系统可根据需要对其用途进行定义，但不包括涉及违反国家法律、法规或危害国家安全的用途。</p>
						<p>2.用户应确保其应用系统能为数字证书提供安全的应用环境，若因网络、主机、操作系统或其他软硬件环境等存在安全漏洞，由此导致的安全事故及相关后果，瑞术科技和CA机构不承担责任。</p>
						<p>3.用户应当妥善保管数字证书以及调用数字证书的验证码或密码，不得泄漏或交付他人。如用户保管不善导致数字证书遭盗用、冒用、伪造或者篡改，用户应当自行承担相关责任。</p>
						<p>4.数字证书对应的私钥为用户本身访问和使用，用户对使用数字证书的行为负责。所有使用数字证书在网络上签署电子文件或进行其他活动均视为用户所为，因此而产生的相关后果应当由用户自行承担。</p>
						<p>5.数字证书一律不得转让、转借或转用。因转让、转借或转用而产生的相关后果应当由用户自行承担。</p>
						<p>6.如遇数字证书遗失、被窃，或数字证书私钥泄露，用户应当立即到数字证书颁发的CA机构申请注销证书。</p>
						<span>第五条 更新</span>
						<p>1.数字证书的有效期根据数字证书上的记录确定，有效期为1年，自签发之日起计算，瑞术科技保证您在使用我们的瑞签云平台电子认证服务时，您的数字证书处于有效期内。</p>
						<p>2.因技术需要，如遇证书中的信息发生变更，用户应及时通过瑞术科技向CA机构申请更新证书。若用户未及时更新证书，因此而产生的相关后果应当由用户自行负责。</p>
						<span>第六条 吊销</span>
						<p>1.如遇数字证书私钥泄露丢失、证书中的信息发生重大变更、或用户不希望继续使用数字证书的情况，用户应当立即向CA机构申请吊销证书。吊销手续遵循注册机构的规定。用户应当承担在证书吊销之前所有因使用数字证书而造成的责任。</p>
						<p>2.如果用户主体资格灭失（如企业注销等），法定代表人或授权代表通过瑞术科技向CA机构请求吊销用户证书，用户主体及相关责任人应当承担其数字证书在吊销前所有使用数字证书而造成的相关后果。</p>
						<p>3.于下列情形之一，CA机构有权主动吊销所签发的证书：</p>
						<p>(1)用户申请证书时，提供不真实信息；</p>
						<p>(2)证书对应的私钥泄露或出现其他证书的安全性得不到保证的情况；</p>
						<p>(3)用户不能履行或违反了相关法律、法规和本协议所规定的责任和义务；</p>
						<p>(4)法律、法规规定的其他情形</p>
						<span>第七条 其他</span>
						<p>1.瑞术科技与CA机构不对由于意外事件或其他不可抗力事件而导致暂停或终止全部或部分证书服务承担任何责任。前述状况包括但不限于：</p>
						<p>（1）CA机构系统停机维护期间。</p>
						<p>（2）电信设备出现故障不能进行数据传输的。</p>
						<p>（3）因台风、地震、海啸、洪水、停电、战争、恐怖袭击等不可抗力之因素，造成瑞术接待系统障碍不能执行业务操作。</p>
						<p>2.本协议的解释适用中华人民共和国法律。若发生任何纠纷或争议，首先应友好协商解决，协商不成的，争议方均可提请福州仲裁委员会按照该会有效的仲裁规则进行仲裁。仲裁裁决是终局的，对双方均具有约束力。</p>
						<p>3.用户确认已经认真阅读并完全理解本协议中的各项规定，用户一旦在本页面点击同意即表明接受本协议的约束，本协议即时生效。</p>
					</div>
		            <div class="modal-footer">
		                <button type="button" class="btn btn-default" data-dismiss="modal">同意</button>
		                <!-- <button type="button" class="btn btn-primary">提交更改</button> -->
		            </div>
		        </div><!-- /.modal-content -->
		    </div><!-- /.modal -->
		</div>
	</body>
	<script src="js/jquery-3.3.1.min.js"></script>
	<script src="js/bootstrap.js"></script>
	<script src="js/ext.js"></script>
	<script src="js/common.js"></script>
	<script src="js/jquery.qrcode.min.js"></script>
	<script type='text/javascript' src='https://webchat.7moor.com/javascripts/7moorInit.js?accessId=321066d0-948f-11e8-ae85-f7c4a95d6890&autoShow=true&language=ZHCN' async='async'></script>
	<script type="text/javascript">
		var flat = true;
		$(document).ready(function() {
			$("input[name=legalCard]").val(getCookie("idCard"));
			$("input[name=mobilePhone]").val(getCookie("mobilePhone"));
		})
		var processStatus = getCookie("processStatus");
		$('#orgCertificateBase64').on('DOMNodeInserted', function() {
			if ($(this).find('input').length == 0) {
				return
			};
			if (flat) {
				flat = false;
				var photoBase64 = $("input[name=orgCertificateBase64]").val();
				var index = photoBase64.lastIndexOf(".");
				photoBase64Type = photoBase64.substring(index + 1, photoBase64.length);
				$.showProgressBar("正在识别..");
				$.ajax({
					type: 'POST',
					url: "auth/discern",
					data: {
						"photoType": 1,
						"photoBase64": photoBase64,
						"extName": photoBase64Type
					},
					success: function(data) {
						$.closeProgressBar(function() {});
						if (data.code == 0) {
							if (JSON.stringify(data.data.ocrInfo) != "{}") {
								$("input[name=enterpriseName]").val(data.data.ocrInfo.companyName);
								$("input[name=regNum]").val(data.data.ocrInfo.regNum);
								$("input[name=legalName]").val(data.data.ocrInfo.legalPerson);
								$("input[name=establishDate]").val(data.data.ocrInfo.establishDate);
								$("input[name=business]").val(data.data.ocrInfo.business);
								$("input[name=address]").val(data.data.ocrInfo.address);
								$("input[name=capital]").val(data.data.ocrInfo.capital);
							} else {
								$('#orgCertificateBase64').children("input").val("");
								$('#orgCertificateBase64').children("img").remove();
								$.shotTotal('OCR识别失败请重新上传识别！', "error");
							}
						} else {
							$('#orgCertificateBase64').children("input").val("");
							$('#orgCertificateBase64').children("img").remove();
							$.shotTotal(data.message, "error");
						}
						flat = true;
					},
					error: function(data) {
						$.closeProgressBar(function() {});
						$('#orgCertificateBase64').children("input").val("");
						$('#orgCertificateBase64').children("img").remove();
						$.shotTotal("OCR识别接口请求服务器失败。", "error");
						flat = true;
					},
					dataType: "json"
				});

			}
		})
		$("#submit").click(function() {
			var data = getFromData();
			data.identityType = "1";
			data.loginName = getCookie("loginName");
			data.change = "0";
			data.orgCertificateBase64 = data.orgCertificateBase64;
			data.officialSealBase64 = data.officialSealBase64;
			if(processStatus == "5"){
				data.change = "1";
			}
			$.showProgressBar("信息提交中...");
			$.ajax({
				url: "auth/companyAuth",
				type: 'POST',
				data: data,
				success: function(result) {
					if ("0000" == result.code) {
						$.closeProgressBar(function() {
							$.shotTotal(result.message, "success");
							getProcessStatus();
						});
					} else {
						$.closeProgressBar(function() {
							$.shotTotal(result.message, "error");
						});
					}
				},
				error: function() {
					$.closeProgressBar(function() {
						$.shotTotal("出错了！", "error");
					});
				}
			});
		})
		// 验证码倒计时
		var countdown = 60;

		function setTimeOutLog() {
			var val = $("#getsmsCode");
			if (countdown == 0) {
				val.removeAttr("disabled");
				val.html("获取验证码");
				countdown = 60;
				return false;
			} else {
				val.attr("disabled", "disabled");
				val.html("重新发送(" + countdown + ")");
				countdown--;
			}
			setTimeout(function() {
				setTimeOutLog();
			}, 1000);
		}
		// 发送短信
		function getSmsCode() {
			$.showProgressBar("发送短信中...");
			$.ajax({
				url: "smsCode",
				type: 'POST',
				data: {
					'mobilePhone': $("input[name=mobilePhone]").val(),
					msgType: "10"
				},
				success: function(result) {
					if ("0000" == result.code) {
						$.closeProgressBar(function() {
							// window.location.href = result.message;
							$.shotTotal(result.message, "success");
							setTimeOutLog();
						});
					} else {
						$.closeProgressBar(function() {
							$.shotTotal(result.message, "error");
						});
					}
				},
				error: function() {
					$.closeProgressBar(function() {
						$.shotTotal("出错了！", "error");
					});
				}
			});
		}
// 		function geLegalPersonData(){
// 			$.showProgressBar("获取数据中...");
// 			$.ajax({
// 				url: "smsCode",
// 				type: 'POST',
// 				msgType: "10"
// 				data: {
// 					'mobilePhone': $("input[name=mobilePhone]").val(),
// 				},
// 				success: function(result) {
// 					if ("0000" == result.code) {
// 						$.closeProgressBar(function() {
// 							setData(result.data);
// 						});
// 					} else {
// 						$.closeProgressBar(function() {
// 							$.shotTotal(result.message, "error");
// 						});
// 					}
// 				},
// 				error: function() {
// 					$.closeProgressBar(function() {
// 						$.shotTotal(result.message, "error");
// 					});
// 				}
// 			});
// 		}
// 		function setData(data){
// 			$("input[name=orgCertificateBase64]").val(data.orgCertificateBase64);
// 			$("input[name=officialSealBase64]").val(data.officialSealBase64);
// 			$("input[name=enterpriseName]").val(data.enterpriseName);
// 			$("input[name=address]").val(data.address);
// 			$("input[name=business]").val(data.business);
// 			$("input[name=capital]").val(data.capital);
// 			$("input[name=establishDate]").val(data.establishDate);
// 			$("input[name=regNum]").val(data.regNum);
// 			$("input[name=legalName]").val(data.legalName);
// 			$("input[name=legalCard]").val(data.legalCard);
// 			$("input[name=mobilePhone]").val(data.mobilePhone);
// 			$("input[name=smsCode]").val(data.smsCode);
// 			$("#orgCertificateBase64 img").attr("src",);
// 			$("#officialSealBase64 img").attr("src",);
// 		}
	</script>
</html>
